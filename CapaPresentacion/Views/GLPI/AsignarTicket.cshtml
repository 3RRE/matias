
@{
    ViewBag.Title = "AsignarTicket";
}

@section css{
    <link href="~/Content/assets/css/cssviews/GPLI/asignarTicket.css" rel="stylesheet" />
    <link href="~/Content/assets/css/cssviews/GPLI/crearTicket.css" rel="stylesheet" />
    <link href="~/Content/assets/css/cssviews/GPLI/general.css" rel="stylesheet" />


    <link href="~/Content/assets/css/cssviews/GPLI/TicketsAsignados.css" rel="stylesheet" />
}


<style>
    .add-icon {
        height: 28px;
        width: 30px;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #ffa70f;
        color: white;
        cursor: pointer;
    }
    /* Contenedor principal */
    .correos-container {
        display: flex;
        gap: 5px;
        flex-wrap: wrap;
        margin-top: 10px;
    }

    /* Estilo de cada correo */
    .correo-item {
        display: inline-flex;
        align-items: center;
        background-color: #cce4ff;
        color: #004085;
        padding: 1px 18px;
        border-radius: 30px !important;
        position: relative;
        cursor: default;
        font-size: 14px;
        font-weight: bold;
    }

    /* Botón de eliminar */
    .delete-btn {
        position: absolute;
        right: -5px;
        top: -5px;
        background-color: #dc3545;
        color: white;
        border: none;
        border-radius: 50% !important;
        height: 20px;
        font-size: 14px;
        font-weight: bold;
        display: none;
        cursor: pointer;
    }

    /* Mostrar el botón al hacer hover */
    .correo-item:hover .delete-btn {
        display: block;
    }

    /* Efecto hover en el botón eliminar */
    .delete-btn:hover {
        background-color: #bd2130;
    }

    .autocomplete-list {
        position: absolute;
        width: 80%;
        background: white;
        border: 1px solid #ccc;
        border-radius: 8px !important;
        max-height: 200px;
        overflow-y: auto;
        list-style: none;
        padding: 0;
        margin-top: 2px; /* Espacio entre el input y la lista */
        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
        top: 71%;
        z-index: 1000;
    }

        /* Estilo para cada opción de la lista */
        .autocomplete-list li {
            padding: 5px;
            cursor: pointer;
        }

            /* Cambio de color al pasar el mouse */
            .autocomplete-list li:hover {
                background: #f0f0f0;
            }

    /* Contenedor de correos agregados */
    .correos-container {
        margin-top: 10px;
    }

    /* Switch personalizado */
    .switch {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 24px;
    }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: .4s;
        border-radius: 24px !important;
    }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

    input:checked + .slider {
        background-color: #2ecc71;
    }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

    /* Estilos para la tabla */
    .datatable {
        width: 100%;
    }

        .datatable th {
            background: #264f72;
            padding: 12px !important;
            color: white;
        }

        .datatable td {
            padding-left: 12px !important;
        }

    .action-buttons {
        white-space: nowrap;
    }

        .action-buttons .btn {
            padding: 6px 10px;
            margin: 0 2px;
        }

    .table > thead > tr > th {
        border-bottom: 2px solid #ddd;
    }

    .estado-label {
        margin-left: 8px;
        font-size: 12px;
        color: #4a4a4a;
    }

    .editing-row {
        background-color: #fff3cd !important;
        transition: background-color 0.3s ease;
    }

    [v-cloak] {
        display: none !important;
    }

    .ticket-view-toggle {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        margin-bottom: 10px;
        gap: 0.5rem;
    }

    .toggle-btn {
        background: transparent;
        border: none;
        padding: 0.6rem 0.8rem;
        font-size: 1.3rem;
        color: #333; /* texto oscuro por defecto */
        border-radius: 8px;
        transition: all 0.2s ease-in-out;
        cursor: pointer;
    }

        .toggle-btn:hover {
            background: rgba(13, 71, 161, 0.1); /* azul translúcido al pasar */
            color: #0d47a1; /* azul oscuro */
        }

        .toggle-btn.active {
            background: #0d47a1; /* azul sólido para activo */
            color: #ffffff; /* texto blanco para contraste */
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        }

    .toggle-separator {
        font-weight: bold;
        color: #999; /* gris medio */
        user-select: none;
    }

    /* Encabezado de tabla */
    .table-header {
        background: #e9eff5;
        color: #333;
        font-weight: 600;
        text-transform: uppercase;
    }

    /* Filas */
    .table-hover tbody {
        background-color: #f9fafc;
    }

        .table-hover tbody tr:hover {
            background-color: #f1f7ff; /* azul muy suave */
        }

    /* Ajuste de celdas en móviles */
    .table td, .table th {
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
        max-width: 180px;
    }

    /* Que sea más legible en pantallas pequeñas */
    @@media (max-width: 768px) {
        .table td, .table th {
            font-size: 0.85rem;
            max-width: 120px;
        }
    }

    .table {
        margin-bottom: 10px;
    }

    .pagination {
        margin: 1px 0;
        display: flex;
        justify-content: center !important;
    }

        .pagination .page-link {
            color: #fff; /* texto blanco */
            background-color: #235ebe; /* azul intermedio */
            border: 1px solid #1c4a91; /* borde más oscuro */
        }

        .pagination .page-item.active .page-link {
            background-color: #1c4a91; /* azul más oscuro para activo */
            border-color: #173a73;
        }

        .pagination .page-link:hover {
            background-color: #173a73; /* hover más oscuro */
            color: #fff;
        }

        .pagination .page-item.disabled .page-link {
            background-color: #2a2a2a; /* gris para deshabilitado */
            color: #888;
        }

</style>

<div id="AppGlpiAsignarTicket" style="text-shadow:none;">

    <div class="header-glpi-container">
        <div class="header-glpi-title">
            <span aria-hidden="true" class="icon las la-map-signs"></span>
            <h2>Asignar Ticket</h2>
        </div>
    </div>

    <div class="container-glpi-section"  v-cloak>
        <div class="tabs">
            <div class="custom-tabulador"
                 v-for="tab in filteredTabs"
                 :key="tab.name"
                 :class="{ 'active-tabulador': activeTab === tab.name }"
                 @@click="activeTab = tab.name">
                <svg xmlns="http://www.w3.org/2000/svg"
                     width="20"
                     height="20"
                     fill="none"
                     viewBox="0 0 24 24"
                     stroke="currentColor"
                     class="tab-icon">
                    <path :d="tab.iconPath"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2" />
                </svg>
                <span>{{ tab.label }}</span>
            </div>
        </div>

        <div class="tab-content" >
            <template v-if="filteredTabs.length>0">
                <template v-if="activeTab === 'ticketssinAsignar' ">
                    <template v-if="(tickets.length>0)">
                        @*<div v-if="activeTab === 'ticketssinAsignar' && ticketsQueAsigne && ticketsQueAsigne.length >0">*@
                        @* PRIMERO *@
                        <div class="ticket-view-toggle d-flex justify-content-end mb-3">
                            <span class="toggle-separator">Visualización: </span>
                            <button class="toggle-btn"
                                    :class="{ active: vistaActual === 'lista' }"
                                    @@click="cambiarVista('lista')"
                                    title="Vista Lista">
                                <i class="glyphicon glyphicon-th-list"></i>
                            </button>
                            <span class="toggle-separator">|</span>
                            <button class="toggle-btn"
                                    :class="{ active: vistaActual === 'grid' }"
                                    @@click="cambiarVista('grid')"
                                    title="Vista Cuadrícula">
                                <i class="glyphicon glyphicon-th"></i>
                            </button>
                        </div>


                        <div v-if="vistaActual === 'grid'" class="row ticket-row">

                            <div v-for="(item, index) in tickets" :class="[getStatusClass(item.estado)]" @@click="openModalMainDetail(item.Id,item)" :key="index" class="col-lg-3 col-md-4 col-sm-6 col-12 ticket-column" style="padding-bottom:3rem; height:100%">
                                <div class="ticket-card">
                                    <div class="ticket-side-bar"></div>
                                    <div class="ticket-badge">{{item.FaseTicket}}</div>
                                    <div class="ticket-priority" :class="'priority-' + item.NivelAtencion.Nombre.toLowerCase()">{{item.NivelAtencion.Nombre}}</div>

                                    <div class="ticket-title">
                                        {{item.ClasificacionProblema.Nombre || ' - '}}

                                    </div>

                                    <div class="ticket-category">{{ item.Identificador.Nombre || ' - '}}, {{ item.Sala.Nombre}}</div>

                                    <div class="ticket-status-bar">
                                        <div class="ticket-status-grey">Cargo: {{ item.UsuarioSolicitante.Cargo }}</div>
                                        <div class="ticket-status-grey">{{ item.FechaRegistroStr }}</div>
                                    </div>

                                    <div class="ticket-user-info">
                                        <div class="ticket-user">
                                            <div class="user-avatar">
                                                {{ item.UsuarioSolicitante.Nombres.charAt(0).toUpperCase() }}
                                            </div>
                                            <div class="ticket-user-name">
                                                {{ item.UsuarioSolicitante.Nombres }} {{ item.UsuarioSolicitante.ApellidoPaterno }} {{ item.UsuarioSolicitante.ApellidoMaterno }}<br><small>{{item.UsuarioSolicitante.CorreoTrabajo}}</small>
                                            </div>
                                        </div>
                                        <div class="ticket-number">#{{ item.Id }}</div>
                                    </div>
                                    <div class="button-container-colum-single">
                                        <div class="row">
                                            <button v-if="ticketsAsignados.length>0 && item.CodigoFaseTicket !== 4 && item.CodigoFaseTicket !== 5" @@click.stop="openModalAsignacion(item.Id,item)" class="custom-btn btn-detalle">
                                                <i class="glyphicon glyphicon-user text-icon"></i> Asignar
                                            </button>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div v-if="vistaActual === 'lista'" class="table-responsive" v-cloak>
                            <table class="table table-hover table-bordered align-middle">
                                <thead class="table-header">
                                    <tr>
                                        <th class="text-center" @@click="sortTable('Id')">
                                            #
                                            <span v-if="sortColumn === 'Id'">{{ sortOrder === 'asc' ? '▲' : '▼' }}</span>
                                        </th>
                                        <th class="text-center" @@click="sortTable('FaseTicket')">
                                            Fase
                                            <span v-if="sortColumn === 'FaseTicket'">{{ sortOrder === 'asc' ? '▲' : '▼' }}</span>
                                        </th>
                                        <th class="text-center">Prioridad</th>
                                        <th class="text-center">Título</th>
                                        <th class="text-center">Categoría</th>
                                        <th class="text-center">Fecha Registro</th>
                                        <th class="text-center">Solicitante</th>
                                        <th class="text-center">Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="(item, index) in tickets" :key="item.Id">
                                        <td class="text-center">{{ item.Id }}</td>
                                        <td class="text-center">{{ item.FaseTicket }}</td>
                                        <td class="ticket-priority-table" :class="'priority-' + item.NivelAtencion.Nombre.toLowerCase()">
                                            {{ item.NivelAtencion.Nombre }}
                                        </td>
                                        <td>{{ item.ClasificacionProblema.Nombre || '-' }}</td>
                                        <td>{{ item.Identificador.Nombre || '-' }}, {{ item.Sala.Nombre }}</td>
                                        <td>{{ item.FechaRegistroStr }}</td>
                                        <td>
                                            <strong>{{ item.UsuarioSolicitante.Nombres }} {{ item.UsuarioSolicitante.ApellidoPaterno }}</strong><br>
                                            <small>{{ item.UsuarioSolicitante.CorreoTrabajo }}</small>
                                        </td>
                                        <td>
                                            <button @@click="openModalMainDetail(item.Id,item)" class="btn btn-sm btn-primary" title="Ver Detalle">
                                                <i class="glyphicon glyphicon-info-sign"></i>
                                            </button>
                                            <button v-if="ticketsAsignados.length>0 && item.CodigoFaseTicket !== 4 && item.CodigoFaseTicket !== 5" @@click.stop="openModalAsignacion(item.Id,item)" class="btn btn-sm btn-primary">
                                                <i class="glyphicon glyphicon-user"></i> Asignar
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            @*✅ Paginación*@
                            <div class="d-flex justify-content-center align-items-center mt-3">
                                <nav class="d-flex justify-content-center w-100">
                                    <ul class="d-flex justify-content-center pagination pagination-sm mb-0">
                                        @*Botón Anterior*@
                                        <li class="page-item" :class="{ disabled: currentPage === 1 }">
                                            <a class="page-link" href="#" @@click.prevent="currentPage > 1 && currentPage--">«</a>
                                        </li>

                                        @*Primera página*@
                                        <li v-if="pages[0] !== 1" class="page-item">
                                            <a class="page-link" href="#" @@click.prevent="currentPage = 1">1</a>
                                        </li>
                                        <li v-if="pages[0] > 2" class="page-item disabled">
                                            <span class="page-link">...</span>
                                        </li>

                                        @*Páginas intermedias*@
                                        <li v-for="page in pages" :key="page" class="page-item"
                                            :class="{ active: page === currentPage }">
                                            <a class="page-link" href="#" @@click.prevent="currentPage = page">{{ page }}</a>
                                        </li>

                                        @*Última página*@
                                        <li v-if="pages[pages.length - 1] < totalPages - 1" class="page-item disabled">
                                            <span class="page-link">...</span>
                                        </li>
                                        <li v-if="pages[pages.length - 1] < totalPages" class="page-item">
                                            <a class="page-link" href="#" @@click.prevent="currentPage = totalPages">{{ totalPages }}</a>
                                        </li>

                                        @*Botón Siguiente*@
                                        <li class="page-item" :class="{ disabled: currentPage === totalPages }">
                                            <a class="page-link" href="#" @@click.prevent="currentPage < totalPages && currentPage++">»</a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>

                        </div>
                    </template>
                    <template v-else>
                        <p>No hay tickets registrados.</p>
                    </template>
                </template>

                <template v-if="activeTab === 'sinAsignarTickets'">
                    <template v-if="ticketsAsignados.length >0">
                        @* SEGUNDO *@
                        <div class="ticket-view-toggle d-flex justify-content-end mb-3">
                            <span class="toggle-separator">Visualización: </span>
                            <button class="toggle-btn"
                                    :class="{ active: vistaActual === 'lista' }"
                                    @@click="cambiarVista('lista')"
                                    title="Vista Lista">
                                <i class="glyphicon glyphicon-th-list"></i>
                            </button>
                            <span class="toggle-separator">|</span>
                            <button class="toggle-btn"
                                    :class="{ active: vistaActual === 'grid' }"
                                    @@click="cambiarVista('grid')"
                                    title="Vista Cuadrícula">
                                <i class="glyphicon glyphicon-th"></i>
                            </button>
                        </div>


                        <div v-if="vistaActual === 'grid'" class="row ticket-row">

                            <div v-for="(item, index) in renderTickets(ticketsAsignados)" @@click="openModalMainDetail(item.Id,item)" :key="index" class="col-lg-3 col-md-4 col-sm-6 col-12 ticket-column" style="padding-bottom:3rem; height:100%">
                                <div class="ticket-card" :class="{ 'fondo-atrasado': isAtrasado(item.Asignacion.FechaTentativaTermino) }">
                                    @* style="height:352px !important" *@
                                    <div class="ticket-side-bar"></div>
                                    <div class="ticket-badge">{{item.FaseTicket}}</div>
                                    <div class="ticket-priority" :class="'priority-' + item.NivelAtencion.Nombre.toLowerCase()">{{item.NivelAtencion.Nombre}}</div>

                                    <div class="ticket-title">
                                        {{item.ClasificacionProblema.Nombre || ' - '}}

                                    </div>

                                    <div class="ticket-category">{{ item.Identificador.Nombre || ' - '}}, {{ item.Sala.Nombre}}</div>

                                    <div class="ticket-status-bar">
                                        <div class="ticket-status-grey">Cargo: {{ item.Asignacion.UsuarioAsignado.Cargo }}</div>
                                        <div class="ticket-status-grey">{{ item.Asignacion.FechaTentativaTerminoStr }}</div>
                                    </div>

                                    <div class="ticket-user-info">
                                        <div class="ticket-user">
                                            <div class="user-avatar">
                                                {{ item.Asignacion.UsuarioAsignado.Nombres.charAt(0).toUpperCase() }}
                                            </div>
                                            <div class="ticket-user-name">
                                                {{ item.Asignacion.UsuarioAsignado.Nombres }} {{ item.Asignacion.UsuarioAsignado.ApellidoPaterno }} {{ item.Asignacion.UsuarioAsignado.ApellidoMaterno }}<br><small>{{item.Asignacion.UsuarioAsignado.CorreoTrabajo}}</small>
                                            </div>
                                        </div>
                                        <div class="ticket-number">#{{ item.Id }}</div>
                                    </div>
                                    <div class="button-container-colum">

                                        <div class="row">
                                            <button v-if="ticketsAsignados.length>0 && item.CodigoFaseTicket !== 4 && item.CodigoFaseTicket !== 5" @@click.stop="openModalDetailAsignacion(item.Id,item)" class="custom-btn btn-detalle">
                                                <i class="glyphicon glyphicon-user text-icon"></i> Asignación
                                            </button>
                                            <button @@click.stop="openModalDetail(item.Id,item)" class="custom-btn btn-seguimiento">
                                                <i class="glyphicon glyphicon-eye-open text-icon"></i> Seguimiento
                                            </button>
                                        </div>
                                        <div class="row">
                                            <button v-if="ticketsAsignados.length>0 && item.CodigoFaseTicket === 3" @@click.stop="openCierreModal(item.Id, item)" class="custom-btn btn-eliminar">
                                                <i class="glyphicon glyphicon-ok text-icon"></i> Finalizar
                                            </button>
                                            <button v-if="item.CodigoFaseTicket == 2" @@click.stop="openEditFormAsignar(item.Id,item)" class="custom-btn btn-editar">
                                                <i class="glyphicon glyphicon-edit text-icon"></i> Editar
                                            </button>
                                            <button v-if="ticketsAsignados.length>0 && item.CodigoFaseTicket !== 4 && item.CodigoFaseTicket !== 5" @@click.stop="openModalSeguimiento(item.Id,item)" class="custom-btn btn-nuevo">
                                                <i class="glyphicon glyphicon-plus text-icon"></i> Añadir Segui.
                                            </button>
                                        </div>

                                    </div>

                                </div>

                            </div>
                        </div>
                        <div v-if="vistaActual === 'lista'" class="table-responsive" v-cloak>
                            <table class="table table-hover table-bordered align-middle">
                                <thead class="table-header">
                                    <tr>
                                        <th class="text-center" @@click="sortTable('Id')">
                                            #
                                            <span v-if="sortColumn === 'Id'">{{ sortOrder === 'asc' ? '▲' : '▼' }}</span>
                                        </th>
                                        <th class="text-center" @@click="sortTable('FaseTicket')">
                                            Fase
                                            <span v-if="sortColumn === 'FaseTicket'">{{ sortOrder === 'asc' ? '▲' : '▼' }}</span>
                                        </th>
                                        <th class="text-center">Prioridad</th>
                                        <th class="text-center">Título</th>
                                        <th class="text-center">Categoría - Sala</th>
                                        <th class="text-center">Fecha Registro</th>
                                        <th class="text-center">Asignado a</th>
                                        <th class="text-center">Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="(item, index) in renderTickets(ticketsAsignados)" :key="item.Id">
                                        <td class="text-center">{{ item.Id }}</td>
                                        <td class="text-center">{{ item.FaseTicket }}</td>
                                        <td class="ticket-priority-table" :class="'priority-' + item.NivelAtencion.Nombre.toLowerCase()">
                                            {{ item.NivelAtencion.Nombre }}
                                        </td>
                                        <td>{{ item.ClasificacionProblema.Nombre || '-' }}</td>
                                        <td>{{ item.Identificador.Nombre || '-' }} - {{ item.Sala.Nombre }}</td>
                                        <td>{{ item.FechaRegistroStr }}</td>
                                        <td>
                                            <strong>{{ item.Asignacion.UsuarioAsignado.Nombres }} {{ item.UsuarioSolicitante.ApellidoPaterno }}</strong><br>
                                            <small>{{ item.Asignacion.UsuarioAsignado.CorreoTrabajo }}</small>
                                        </td>
                                        <td>
                                            <button @@click="openModalMainDetail(item.Id,item)" class="btn btn-sm btn-primary" title="Ver Detalle">
                                                <i class="glyphicon glyphicon-info-sign"></i>
                                            </button>
                                            <button v-if="ticketsAsignados.length>0 && item.CodigoFaseTicket !== 4 && item.CodigoFaseTicket !== 5" @@click.stop="openModalDetailAsignacion(item.Id,item)" class="btn btn-sm btn-primary" title="Asignación">
                                                <i class="glyphicon glyphicon-user"></i> 
                                            </button>
                                            <button @@click.stop="openModalDetail(item.Id,item)" class="btn btn-sm btn-info" title="Ver Seguimiento">
                                                <i class="glyphicon glyphicon-eye-open" ></i> 
                                            </button>
                                            <button v-if="ticketsAsignados.length>0 && item.CodigoFaseTicket === 3" @@click.stop="openCierreModal(item.Id, item)" class="btn btn-sm btn-danger" title="Finalizar">
                                                <i class="glyphicon glyphicon-ok"></i> 
                                            </button>
                                            <button v-if="item.CodigoFaseTicket == 2" @@click.stop="openEditFormAsignar(item.Id,item)" class="btn btn-sm btn-warning" title="Editar Asignación">
                                                <i class="glyphicon glyphicon-edit"></i> 
                                            </button>
                                            <button v-if="ticketsAsignados.length>0 && item.CodigoFaseTicket !== 4 && item.CodigoFaseTicket !== 5" @@click.stop="openModalSeguimiento(item.Id,item)" class="btn btn-sm btn-success" title="Añadir Segui.">
                                                <i class="glyphicon glyphicon-plus "></i> 
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            @*✅ Paginación*@
                            <div class="d-flex justify-content-center align-items-center mt-3">
                                <nav class="d-flex justify-content-center w-100">
                                    <ul class="d-flex justify-content-center pagination pagination-sm mb-0">
                                        @*Botón Anterior*@
                                        <li class="page-item" :class="{ disabled: currentPage === 1 }">
                                            <a class="page-link" href="#" @@click.prevent="currentPage > 1 && currentPage--">«</a>
                                        </li>

                                        @*Primera página*@
                                        <li v-if="pages[0] !== 1" class="page-item">
                                            <a class="page-link" href="#" @@click.prevent="currentPage = 1">1</a>
                                        </li>
                                        <li v-if="pages[0] > 2" class="page-item disabled">
                                            <span class="page-link">...</span>
                                        </li>

                                        @*Páginas intermedias*@
                                        <li v-for="page in pages" :key="page" class="page-item"
                                            :class="{ active: page === currentPage }">
                                            <a class="page-link" href="#" @@click.prevent="currentPage = page">{{ page }}</a>
                                        </li>

                                        @*Última página*@
                                        <li v-if="pages[pages.length - 1] < totalPages - 1" class="page-item disabled">
                                            <span class="page-link">...</span>
                                        </li>
                                        <li v-if="pages[pages.length - 1] < totalPages" class="page-item">
                                            <a class="page-link" href="#" @@click.prevent="currentPage = totalPages">{{ totalPages }}</a>
                                        </li>

                                        @*Botón Siguiente*@
                                        <li class="page-item" :class="{ disabled: currentPage === totalPages }">
                                            <a class="page-link" href="#" @@click.prevent="currentPage < totalPages && currentPage++">»</a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>

                        </div>

                    </template>
                    <template v-else>
                        <p>No hay tickets asignados.</p>
                    </template>
                </template>

                <template v-if="activeTab === 'TicketsQueMeAsignaron'">
                    <template v-if="ticketsRecibidos.length > 0">
                       @* TERCERO *@
                        <div class="row ticket-row">

                            <div v-for="(item, index) in renderTickets(ticketsRecibidos)" @@click="openModalMainDetail(item.Id,item)" :key="index" class="col-lg-3 col-md-4 col-sm-6 col-12 ticket-column" style="padding-bottom:3rem; height:100%">
                                <div class="ticket-card" :class="{ 'fondo-atrasado': isAtrasado(item.Asignacion.FechaTentativaTermino) }">
                                    <div class="ticket-side-bar"></div>
                                    <div class="ticket-badge">{{item.FaseTicket}}</div>
                                    <div class="ticket-priority" :class="'priority-' + item.NivelAtencion.Nombre.toLowerCase()">{{item.NivelAtencion.Nombre}}</div>

                                    <div class="ticket-title">
                                        {{item.ClasificacionProblema.Nombre || ' - '}}

                                    </div>

                                    <div class="ticket-category">{{ item.Identificador.Nombre || ' - '}}, {{ item.Sala.Nombre}}</div>

                                    <div class="ticket-status-bar">
                                        <div class="ticket-status"></div>
                                        <div class="ticket-status-grey">{{ item.Asignacion.FechaTentativaTerminoStr }}</div>
                                    </div>

                                    <div class="ticket-user-info">
                                        <div class="ticket-user">
                                            <div class="user-avatar">
                                                {{ item.Asignacion.UsuarioAsignado.Nombres.charAt(0).toUpperCase() }}
                                            </div>
                                            <div class="ticket-user-name">
                                                {{ item.Asignacion.UsuarioAsignado.Nombres }} {{ item.Asignacion.UsuarioAsignado.ApellidoPaterno }} {{ item.Asignacion.UsuarioAsignado.ApellidoMaterno }}<br><small>{{item.Asignacion.UsuarioAsignado.CorreoTrabajo}}</small>
                                            </div>
                                        </div>
                                        <div class="ticket-number">#{{ item.Id }}</div>
                                    </div>
                                    <div class="button-container">

                                        <button v-if="item.CodigoFaseTicket !== 4 && item.CodigoFaseTicket !== 5" @@click.stop="openModalDetailAsignacion(item.Id,item)" class="custom-btn btn-nuevo" style="flex: 1;">
                                        <i class="glyphicon glyphicon-user text-icon"></i> Asignación
                                        </button>
                                        <button @@click.stop="openModalDetail(item.Id,item)" class="custom-btn btn-nuevo" style="flex: 1;">
                                        <i class="glyphicon glyphicon-eye-open text-icon"></i> Seguimiento
                                        </button>
                                    </div>

                                </div>

                            </div>
                        </div>

                    </template>
                    <template v-else>
                        <p>No hay tickets recibidos.</p>
                    </template>
                </template>
            </template>

            <template v-else>
                <p>No hay tickets registrados.</p>
            </template>

        </div>
    </div>
    @******************************MODAL DETALLE MAIN TICKET ****************************************@
    <div v-if="showModalMainDetail" v-cloak class="modal-overlay">
        <div class="modal-container" :class="{'modal-enter': showModalMainDetail, 'modal-leave': !showModalMainDetail}">
            <div style="position:sticky;top:0;background-color:white;z-index:1;padding:15px;">
                <div class="header-decoration"></div>
                <div style="display:flex;justify-content:space-between;width:100%; ">
                    <h2 style="color: white;">Detalle Ticket</h2>
                    <button @@click="closeModalMainDetail" class="btn btn-close">x</button>
                </div>

                <div class="sheet-input" style="margin-top: 20px;">
                    <div class="sheet-showTop">
                        <div class="sheet-showTop-header">
                            <p class="sheet-showTop-title">#{{ ticketSelect.Id }} - {{ ticketSelect.ClasificacionProblema.Nombre }}</p>
                            <p class="sheet-showTop-level" :style="{ color: ticketSelect.NivelAtencion.Color }">
                                {{ ticketSelect.NivelAtencion.Nombre }}
                            </p>
                        </div>
                        <div class="sheet-showTop-detail" style="justify-self:center">
                            <p>{{ ticketSelect.Identificador.Nombre }}, {{ ticketSelect.Sala.Nombre }}</p>
                        </div>
                    </div>
                </div>

                <div class="sheet-input" style="margin-top: 15px;">
                    <div class="sheet-showText">
                        <p><strong>Usuario Solicitante:</strong> {{ ticketSelect.UsuarioSolicitante.Nombres }} {{ ticketSelect.UsuarioSolicitante.ApellidoPaterno }} {{ ticketSelect.UsuarioSolicitante.ApellidoMaterno }}</p>
                        <p><strong>Cargo:</strong> {{ ticketSelect.UsuarioSolicitante.Cargo }}</p>
                        <p><strong>Numero de Documento:</strong> {{ ticketSelect.UsuarioSolicitante.NumeroDocumento }}</p>
                        <p><strong>Tipo de Operación:</strong> {{ ticketSelect.TipoOperacion.Nombre }}</p>
                        <p><strong>Partida:</strong> {{ ticketSelect.SubCategoria.Categoria.Partida.Nombre }}</p>
                        <p><strong>Categoria:</strong> {{ ticketSelect.SubCategoria.Categoria.Nombre }}</p>
                        <p><strong>SubCategoria:</strong> {{ ticketSelect.SubCategoria.Nombre }}</p>
                        <p><strong>Estado Actual:</strong> {{ ticketSelect.EstadoActual.Nombre }}</p>
                        <p><strong>Identificador:</strong> {{ ticketSelect.Identificador.Nombre }}</p>
                        <p><strong>Descripcion:</strong> {{ ticketSelect.Descripcion ? ticketSelect.Descripcion : "-"}}</p>
                        <p style="border-bottom: unset">
                            <strong>Fecha de Registro:</strong>
                            {{ ticketSelect.FechaRegistroStr }}
                        </p>

                        <div class="sheet-input" v-if="previewList.length > 0">
                            <div class="select-container">
                                <div class="" style="display: flex; justify-content: space-between; margin-bottom:5px">
                                    <p><strong>Archivo:</strong></p>
                                    <div class="" v-if="previewList.length > 0">
                                        <button @@click="openImagePreview(previewList[0].url)" class="btn-viewFile">
                                            <span class="glyphicon glyphicon-eye-open"></span> Ver
                                        </button>
                                    </div>
                                </div>
                                <div :class="['file-upload-container', { 'has-files': previewList.length > 0 }]">
                                    <div v-if="previewList.length === 0" class="file-upload-placeholder">
                                        <p>Haz clic aquí para agregar archivos</p>
                                    </div>
                                    <div v-else class="file-preview">
                                        <div v-for="file in previewList" :key="file.id" :class="['file-item', file.typeClass]">
                                            <img v-if="file.type === 'image'" :src="file.preview" alt="Preview" />
                                            <div v-else v-html="file.icon" style="width: 60px; min-width: 60px;"></div>
                                            <div v-if="file.type !== 'image'">
                                                <span class="file-name">{{ file.name }}</span>
                                                <span class="file-size">{{ file.size }}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    @******************************MODAL CIERRE****************************************@
    <div v-if="showCierreModal" v-cloak id="formCierreTicket" class="modal-overlay">
        <div class="modal-container" :class="{'modal-enter': showCierreModal, 'modal-leave': !showCierreModal}" style="max-width:650px;">
            <div style="position:sticky;top:0;background-color:white;z-index:1;padding:15px;">
                <div class="header-decoration"></div>

                <div style="display:flex;justify-content:space-between;width:100%; ">
                    <h2 style="color: white;">Finalizar Ticket</h2>
                    <button @@click="closeCierreModal" class="btn btn-close">x</button>
                </div>

                <div class="sheet-input" style="margin-top: 20px;">
                    <div class="sheet-showTop">
                        <div class="sheet-showTop-header">
                            <p class="sheet-showTop-title">{{ ticketsDetail.ClasificacionProblema.Nombre }}</p>
                            <p class="sheet-showTop-level" :style="{ color: ticketsDetail.NivelAtencion.Color }">
                                {{ ticketsDetail.NivelAtencion.Nombre }}
                            </p>
                        </div>
                        <div class="sheet-showTop-detail" style="justify-self:center">
                            <p>{{ ticketsDetail.Identificador.Nombre }}, {{ ticketsDetail.Sala.Nombre }}</p>
                        </div>
                    </div>
                </div>

                <div class="sheet-input" style="margin-top: 15px;">
                    <div style="display: flex; flex-direction: column; gap: 2px;">
                        <label>Estado Ticket</label>
                        <div class="select-add-container" style="display:flex;">
                            <select class="select-asignacion" id="cboEstadoTickets" name="cboEstadoTickets"></select>
                            <div class="add-icon" @@click="openModalEstadoTickets('formCierreTicket')">
                                <i class="glyphicon glyphicon-plus-sign"></i>
                            </div>
                        </div>
                    </div>
                    <div style="display:flex; flex-direction:column;gap:2px;">
                        <label>Descripcion</label>
                        <textarea id="txtDescripcion2" name="txtDescripcion2" style="border-radius: 8px !important"></textarea>
                    </div>
                    <div style="margin: 5px; place-self: end;">
                        <button class="btn btn-success" @@click="cerrarTicket">Guardar Cierre</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    @*********************************MODAL DETALLE ASIGNACION*********************************@
    <div v-if="showModalDetailAsignacion" v-cloak class="modal-overlay">
        <div class="modal-container" :class="{'modal-enter': showModalDetailAsignacion, 'modal-leave': !showModalDetailAsignacion}">
            <div style="position:sticky;top:0;background-color:white;z-index:1;padding:15px;">
                <div class="header-decoration"></div>

                <div style="display:flex;justify-content:space-between;width:100%;">
                    <h2 style="color: white;">Asignamiento Ticket</h2>
                    <button @@click="closeModalDetailAsignacion" class="btn btn-close">x</button>
                </div>

                <div class="sheet-input" style="margin-top: 20px;">
                    <div class="sheet-showTop">
                        <div class="sheet-showTop-header">
                            <p class="sheet-showTop-title">#{{ ticketsDetail.Id }} - {{ ticketsDetail.ClasificacionProblema.Nombre }}</p>
                            <p class="sheet-showTop-level" :style="{ color: ticketsDetail.NivelAtencion.Color }">
                                {{ ticketsDetail.NivelAtencion.Nombre }}
                            </p>
                        </div>
                        <div class="sheet-showTop-detail" style="justify-self:center">
                            <p>{{ ticketsDetail.Identificador.Nombre }}, {{ ticketsDetail.Sala.Nombre }}</p>
                        </div>
                    </div>
                    <div class="sheet-showTop-detail" style="font-size: 14px; font-weight: 1; justify-content: space-around">
                        <p><strong style="color: #235ebe">Solicitante: </strong>{{ ticketsDetail.UsuarioSolicitante.Nombres }} {{ ticketsDetail.UsuarioSolicitante.ApellidoPaterno }} {{ ticketsDetail.UsuarioSolicitante.ApellidoMaterno }} - {{ ticketsDetail.UsuarioSolicitante.Cargo }}</p>
                        <p>
                            <strong style="color: #235ebe">Fecha de Registro: </strong>
                            {{ ticketsDetail.FechaRegistroStr }}
                        </p>
                    </div>
                </div>



                <div class="sheet-input" style="margin-top: 15px;">
                    <div class="sheet-showText">
                        <p>
                            <strong style="color: #235ebe">Fecha de asignación: </strong>
                            {{ ticketsAsignadosDetail.FechaRegistroStr }}
                        </p>
                        <p><strong>Estado:</strong> {{ ticketsAsignadosDetail.EstadoTicket.Nombre}}</p>
                        <p><strong>Asignado a:</strong> {{ ticketsAsignadosDetail.UsuarioAsignado.Nombres}} {{ ticketsAsignadosDetail.UsuarioAsignado.ApellidoPaterno}} {{ ticketsAsignadosDetail.UsuarioAsignado.ApellidoMaterno}}</p>
                        <p><strong>Cargo:</strong> {{ ticketsAsignadosDetail.UsuarioAsignado.Cargo}}</p>
                        <p><strong>Documento:</strong> {{ ticketsAsignadosDetail.UsuarioAsignado.NumeroDocumento}}</p>
                        <p><strong>Asignado por:</strong> {{ ticketsAsignadosDetail.UsuarioAsigna.Nombres}} {{ ticketsAsignadosDetail.UsuarioAsigna.ApellidoPaterno}} {{ ticketsAsignadosDetail.UsuarioAsigna.ApellidoMaterno}}</p>
                        <p>
                            <strong>Fecha Tentativa Termino:</strong>
                            {{ ticketsAsignadosDetail.FechaTentativaTerminoStr }}
                        </p>
                    </div>
                </div>

                @*<div style="margin-top: 20px; text-align: right;">
                    <button class="btn btn-primary">
                        Modificar Asignación
                    </button>
                </div>*@

            </div>
        </div>
    </div>

    @*********************************MODAL DETALLE SEGUIMIENTO*********************************@
    <div v-if="showModal" v-cloak class="modal-overlay">
        <div class="modal-container" :class="{'modal-enter': showModal, 'modal-leave': !showModal}">
            <div style="position:sticky;top:0;background-color:white;z-index:1;padding:15px;">
                <div class="header-decoration"></div>

                <div style="display:flex;justify-content:space-between;width:100%;">
                    <h2 style="color: white;">Seguimiento Ticket</h2>
                    <button @@click="closeModalDetail" class="btn btn-close">x</button>
                </div>

                @*<div v-if="ticketsAsignadosDetail.length>0">*@
                <div class="sheet-input" style="margin-top: 20px;">
                    <div class="sheet-showTop">
                        <div class="sheet-showTop-header">
                            <p class="sheet-showTop-title">#{{ ticketsDetail.Id }} - {{ ticketsDetail.ClasificacionProblema.Nombre }}</p>
                            <p class="sheet-showTop-level" :style="{ color: ticketsDetail.NivelAtencion.Color }">
                                {{ ticketsDetail.NivelAtencion.Nombre }}
                            </p>
                        </div>
                        <div class="sheet-showTop-detail" style="justify-self:center">
                            <p>{{ ticketsDetail.Identificador.Nombre }}, {{ ticketsDetail.Sala.Nombre }}</p>
                        </div>
                    </div>
                    <div class="sheet-showTop-detail" style="font-size: 14px; font-weight: 1; display: inline-flex; justify-content: space-around">
                        <p><strong>Asignado a:</strong> {{ ticketsAsignadosDetail.UsuarioAsignado.Nombres}} {{ ticketsAsignadosDetail.UsuarioAsignado.ApellidoPaterno}} {{ ticketsAsignadosDetail.UsuarioAsignado.ApellidoMaterno}} - {{ ticketsAsignadosDetail.UsuarioAsignado.NumeroDocumento}}</p>
                        <p><strong>Cargo:</strong> {{ ticketsAsignadosDetail.UsuarioAsignado.Cargo}}</p>
                    </div>
                </div>
                <div class="sheet-input" style="margin-top: 20px;">
                    <div class="sheet-showText">
                        <p><strong>Fecha de Registro:</strong>{{ ticketsAsignadosDetail.FechaRegistroStr }}</p>

                        <p>
                            <strong>
                                Fecha Tentativa Termino:
                            </strong>
                            {{ ticketsAsignadosDetail.FechaTentativaTerminoStr }}
                        </p>
                        @*<p><strong>Descripción del Problema:</strong> {{ ticketsDetail.Descripcion }}</p>*@
                    </div>
                </div>
                @*</div>*@

                <div class="sheet-input" style="margin-top: 20px; place-items:center">

                    <div v-if="ticketsSeguimientosDetail.length>0">
                        <div v-for="(record, index) in ticketsSeguimientosDetail"
                             :key="record.id">
                            <div class="historial-encabezado" style="display: flex; flex-direction:row; justify-content:space-between">
                                <span class="" style="font-size: 0.9em; color: #555; font-weight: 500;">
                                    #{{index+1}}
                                </span>
                                <span class="" style="font-size: 0.9em; color: #555;">
                                    {{ record.FechaRegistroStr }}
                                </span>
                            </div>
                            <div class="sheet-showText">
                                <p><strong>Usuario:</strong>{{ record.UsuarioRegistra.Nombres }} {{ record.UsuarioRegistra.ApellidoPaterno }} {{ record.UsuarioRegistra.ApellidoMaterno }}</p>
                            </div>
                            <div class="sheet-showText">
                                <p><strong>Estado Ticket:</strong>{{ record.EstadoTicketActual.Nombre }}</p>
                            </div>
                            <div class="sheet-showText">
                                <p><strong>Proceso:</strong>{{ record.ProcesoActual.Nombre }}</p>
                            </div>
                            <div class="sheet-showText" style="border-bottom: 1px solid #e0e0e0;">
                                <p><strong>Descripcion:</strong>{{ record.Descripcion }}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <p v-if="ticketsSeguimientosDetail.length==0" class="sin-historial">No tiene historial de seguimiento</p>

            </div>
        </div>
    </div>
    @*********************************MODAL AGREGAR SEGUIMIENTO*********************************@

    <div v-if="showModalSeguimiento" v-cloak id="formAgregarSeguimiento" class="modal-overlay">
        <div class="modal-container" :class="{'modal-enter': showModalSeguimiento, 'modal-leave': !showModalSeguimiento}" style="max-width:550px;">
            <div style="position:sticky;top:0;background-color:white;z-index:1;padding:15px;">
                <div class="header-decoration"></div>
                <div style="display:flex;justify-content:space-between;width:100%;">
                    <h2 style="color: white;">Agregar seguimiento Ticket</h2>
                    <button @@click="closeModalSeguimiento" class="btn btn-close">x</button>
                </div>
                <div class="sheet-input" style="margin-top: 20px;">

                    <div class="sheet-showTop">
                        <div class="sheet-showTop-header">
                            <p class="sheet-showTop-title">#{{ ticketSelect.Id }} - {{ ticketSelect.ClasificacionProblema.Nombre }}</p>
                            <p class="sheet-showTop-level" :style="{ color: ticketSelect.NivelAtencion.Color }">
                                {{ ticketSelect.NivelAtencion.Nombre }}
                            </p>
                        </div>
                        <div class="sheet-showTop-detail" style="justify-self:center">
                            <p>{{ ticketSelect.Identificador.Nombre }}, {{ ticketSelect.Sala.Nombre }}</p>
                        </div>
                    </div>
                </div>
                <div class="sheet-input" style="margin-top: 15px;">
                    <div style="display: flex; flex-direction: column; gap: 2px;">
                        <label>Estado Ticket</label>
                        <div class="select-add-container" style="display:flex;">
                            <select class="select-asignacion" id="cboEstadoTickets" name="cboEstadoTickets"></select>
                            <div class="add-icon" @@click="openModalEstadoTickets('formAgregarSeguimiento')">
                                <i class="glyphicon glyphicon-plus-sign"></i>
                            </div>
                        </div>
                    </div>
                    <div style="display:flex; flex-direction:column;gap:2px;">
                        <label>Proceso</label>
                        <div class="select-add-container" style="display:flex;">
                            <select class="" id="cboProceso" name="cboProceso"></select>
                            <div class="add-icon" @@click="openModalProceso('formAgregarSeguimiento')">
                                <i class="glyphicon glyphicon-plus-sign"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sheet-input" style="margin-top: 15px;">
                    <label>Correos</label>
                    <div class="autocomplete-container" style="display:flex; position:relative">
                        <input type="text" v-model="nuevoCorreo" id="inputCorreo" @@keydown.enter="agregarCorreos" @@input="filtrarCorreos" autocomplete="off" />
                        <button class="btn btn-success" style="height:26px !important;padding:revert !important; border-radius: 8px !important;" @@click="agregarCorreos">Agregar</button>

                        <ul v-if="correosFiltrados.length>0" class="autocomplete-list">
                            <li v-for="(correo, index) in correosFiltrados" :key="index" @@click="seleccionarCorreo(correo)">
                                {{correo}}
                            </li>
                        </ul>
                    </div>

                    <div class="correos-container">
                        <div v-for="(correo, index) in correos"
                             :key="index"
                             class="correo-item">
                            {{ correo}}
                            <button class="delete-btn" @@click="quitarCorreos(index)">×</button>
                        </div>
                    </div>
                </div>

                <div style="display:flex; flex-direction:column;gap:2px;">
                    <label>Descripcion</label>
                    <textarea id="txtDescripcion" style="border-radius: 8px !important"></textarea>
                </div>
            </div>

            <div style="margin: 5px; place-self: end;">
                <button class="btn btn-success" @@click="agregarSeguimiento(ticketSelect.Id)"><i class="glyphicon glyphicon-ok"></i> Seguimiento</button>
            </div>
        </div>
    </div>

    @*********************************MODAL AGREGAR ASIGNACION*********************************@

    <div v-if="showModalAsignacion" v-cloak id="formAgregarEditarAsignacion" class="modal-overlay">
        <div class="modal-container" :class="{'modal-enter': showModalAsignacion, 'modal-leave': !showModalAsignacion}">
            <div style="position:sticky;top:0;background-color:white;z-index:1;padding:15px;">
                <div class="header-decoration"></div>

                <div style="display:flex;justify-content:space-between;width:100%;">
                    <h2 style="color: white;">{{ isEditing? 'Editar Asignación' : 'Asignación Ticket'}}</h2>
                    <button @@click="closeModalAsignacion" class="btn btn-close">x</button>
                </div>

                <div class="sheet-input" style="margin-top: 20px;">
                    <div class="sheet-showTop">
                        <div class="sheet-showTop-header">
                            <p class="sheet-showTop-title">#{{ ticketsDetail.Id }} - {{ ticketsDetail.ClasificacionProblema.Nombre }}</p>
                            <p class="sheet-showTop-level" :style="{ color: ticketsDetail.NivelAtencion.Color }">
                                {{ ticketsDetail.NivelAtencion.Nombre }}
                            </p>
                        </div>
                        <div class="sheet-showTop-detail" style="justify-self:center">
                            <p>{{ ticketsDetail.Identificador.Nombre }}, {{ ticketsDetail.Sala.Nombre }}</p>
                        </div>
                    </div>
                    <div class="sheet-showTop-detail" style="font-size: 14px; font-weight: 1; justify-content: space-around">
                        <p><strong style="color: #235ebe">Solicitante: </strong>{{ ticketsDetail.UsuarioSolicitante.Nombres }} {{ ticketsDetail.UsuarioSolicitante.ApellidoPaterno }} {{ ticketsDetail.UsuarioSolicitante.ApellidoMaterno }}  - {{ ticketsDetail.UsuarioSolicitante.Cargo }} </p>
                        <p>
                            <strong style="color: #235ebe">Fecha de Registro: </strong>
                            {{ ticketsDetail.FechaRegistroStr }}
                        </p>
                    </div>
                </div>

                <div class="sheet-input" style="margin-top: 15px;">

                    <div style="display: flex; flex-direction: column; gap: 2px;">
                        <label>Estado Ticket</label>
                        <div class="select-add-container" style="display:flex;">
                            <select class="select-asignacion" id="cboEstadoTickets" name="cboEstadoTickets"></select>
                            <div class="add-icon" @@click="openModalEstadoTickets('formAgregarEditarAsignacion')">
                                <i class="glyphicon glyphicon-plus-sign"></i>
                            </div>
                        </div>
                    </div>
                    <label>Empleado</label>
                    <div class="select-add-container" style="display: flex">
                        <select class="" id="cboEmpleados" name="cboEmpleados"></select>
                        <div class="add-icon" @@click="openModalEmpleado">
                            <i class="glyphicon glyphicon-plus-sign"></i>
                        </div>
                    </div>

                    <div class="sheet-input">
                        <label>Correos</label>
                        <div class="autocomplete-container" style="display:flex; position:relative">
                            <input type="text" v-model="nuevoCorreo" id="inputCorreo" @@keydown.enter="agregarCorreos" @@input="filtrarCorreos" autocomplete="off" />
                            <button class="btn btn-success" style="height:26px !important;padding:revert !important; border-radius: 8px !important;" @@click="agregarCorreos">Agregar</button>

                            <ul v-if="correosFiltrados.length>0" class="autocomplete-list">
                                <li v-for="(correo, index) in correosFiltrados" :key="index" @@click="seleccionarCorreo(correo)">
                                    {{correo}}
                                </li>
                            </ul>
                        </div>

                        <div class="correos-container">
                            <div v-for="(correo, index) in correos"
                                 :key="index"
                                 class="correo-item">
                                {{ correo}}
                                <button class="delete-btn" @@click="quitarCorreos(index)">×</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="fechaFin">Fecha Tentativa Termino</label>
                        <input type="datetime-local" class="form-control" id="fechaFin" :min="minDate">
                    </div>
                </div>

                <div style="margin: 5px; place-self: end;">
                    <button class="btn btn-success" @@click="saveAsignacionTicket(isEditing)"><i class="glyphicon glyphicon-ok"></i> {{ isEditing ? 'Editar' : 'Asignar'}}</button>
                </div>
            </div>
        </div>
    </div>

    @*MODAL REGISTRAR USUARIO*@
    <div v-if="modalRegistrarEmpleado" v-cloak class="modal-overlay">
        <div class="modal-container" :class="{'modal-enter': showModalRegistrarEmpleado, 'modal-leave': !showModalRegistrarEmpleado}">
            <div style="position:sticky;top:0;background-color:white;z-index:1;padding:15px;">
                <div class="header-decoration"></div>

                <div style="display: flex; justify-content: space-between; width: 100%;">
                    <h2 style="color: white;">Crear empleado</h2>
                    <button @@click="toggleModalRegistrarEmpleado(false)" class="btn btn-close">x</button>
                </div>
                <div class="sheet-input" style="margin-top:15px;">

                    <div style="display:flex; flex-direction:column;gap:2px; ">
                        <label>Nombres</label>
                        <input id="nombresEmpleado" />
                    </div>

                    <div style="display:flex; flex-direction:column;gap:2px;">
                        <label>Apellido Paterno</label>
                        <input id="apellidoPaternoEmpleado" />
                    </div>
                    <div style="display:flex; flex-direction:column;gap:2px;">
                        <label>Apellido Materno</label>
                        <input id="apellidoMaternoEmpleado" />
                    </div>
                    <div style="display:flex; flex-direction:column;gap:2px;">
                        <label>Cargo</label>
                        <select id="cboCargos"></select>
                    </div>
                    <div style="display:flex; flex-direction:column;gap:2px;">
                        <label>Tipo de documento</label>
                        <select id="cboTipoDocumento">
                            <option value="1">DNI</option>
                            <option value="2">Carnet de Extranjería</option>
                        </select>
                    </div>
                    <div style="display:flex; flex-direction:column;gap:2px;">
                        <label>Nro. documento</label>
                        <input id="numeroDocumentoEmpleado" />
                    </div>
                    <div style="display:flex; flex-direction:column;gap:2px;">
                        <label>Teléfono</label>
                        <input id="telefonoEmpleado" />
                    </div>
                    <div style="display:flex; flex-direction:column;gap:2px;">
                        <label>Nombre del usuario</label>
                        <input id="nombreUsuario" />
                    </div>
                    <div style="display:flex; flex-direction:column;gap:2px;">
                        <label>Contraseña temporal</label>
                        <input id="contraseniaUsuario" />
                    </div>
                    <div style="display:flex; flex-direction:column;gap:2px;">
                        <label>Rol</label>
                        <select id="cboRol"></select>
                    </div>
                </div>
                <div style="margin: 5px; place-self: end;">
                    <button class="btn btn-success" @@click="crearEmpleado">Registrar</button>
                </div>
            </div>
            <div v-if="showModalRegistrarEmpleado" id="ticket-history" class="container-historial">
                <div class="timeline">
                    <div v-for="(record, index) in historial"
                         :key="record.id"
                         :class="['timeline-item', index % 2 === 0 ? 'left' : 'right']">
                        <div class="timeline-content">
                            <h4>{{ record.title }}</h4>
                            <p>{{ record.description }}</p>
                            <span class="date">{{ new Date(record.date).toLocaleString() }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    @*********************************MODAL CRUD ESTADO TICKETS*********************************@
    <div v-if="showModalEstadoTickets" v-cloak class="modal-overlay">
        <div class="modal-container">
            <div style="position:sticky;top:0;background-color:white;z-index:1;padding:15px;">
                <div class="header-decoration" style="padding: 35px"></div>
                <div style="display:flex;justify-content:space-between;width:100%;">
                    <h2 style="color: white;">{{ isEditingEstado ? 'Editar Estado' : 'Agregar Estado' }}</h2>
                    <button @@click="closeModalEstadoTickets" class="btn btn-close">x</button>
                </div>
            </div>
            <div class="modal-body">
                <!-- Formulario de ingreso -->
                <div v-if="!isEditingEstado" style="display: flex">
                    <input class="form-control" placeholder="Ingrese el nombre del Estado" type="text" v-model="nuevoEstadoNombre" id="estadoTicketNombre" @@keyup.enter="guardarEstadoTicket" />
                    <button @@click="guardarEstadoTicket" class="btn btn-success" style="padding: 9px;"><i class="glyphicon glyphicon-ok"></i> Guardar</button>
                </div>
                <div v-else style="display: flex">
                    <input class="form-control" placeholder="Ingrese el nombre del Estado" type="text" v-model="estadoEditadoNombre" id="estadoTicketEditNombre" @@keyup.enter="actualizarEstadoTicket" />
                    <button @@click="actualizarEstadoTicket" class="btn btn-success" style="padding: 9px;"><i class="glyphicon glyphicon-pencil"></i> Actualizar</button>
                </div>

                <!-- DataTable -->
                <div class="table-responsive" style="border-radius: 8px !important; margin-top: 10px">
                    <table class="table table-striped table-hover datatable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th class="text-center">Acciones</th>
                            </tr>
                        </thead>
                        <tbody style="background: #f9fafb ">
                            <tr v-for="(estado, index) in estadosTicket" :key="estado.Id" :class="{'editing-row': isEditingEstado && estadoEditadoIndex === index}">
                                <td>{{ estado.Id }}</td>
                                <td>{{ estado.Nombre }}</td>
                                <td class="text-center action-buttons">
                                    <button @@click="editarEstadoTicket(index)" class="btn btn-warning btn-sm">
                                        <i class="glyphicon glyphicon-pencil"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    @*********************************MODAL CRUD PROCESO*********************************@
    <div v-if="modalProceso" v-cloak class="modal-overlay">
        <div class="modal-container">
            <div style="position:sticky;top:0;background-color:white;z-index:1;padding:15px;">
                <div class="header-decoration" style="padding: 35px"></div>
                <div style="display:flex;justify-content:space-between;width:100%;">
                    <h2 style="color: white;">{{ proceso.isEditingProceso ? 'Editar Proceso' : 'Agregar Proceso' }}</h2>
                    <button @@click="closeModalProceso" class="btn btn-close">x</button>
                </div>
            </div>
            <div class="modal-body">
                <!-- Formulario de ingreso -->
                <div v-if="!proceso.isEditingProceso" style="display: flex">
                    <input class="form-control" placeholder="Ingrese el nombre del Proceso" type="text" v-model="proceso.nuevoProcesoNombre" id="procesoNombre" @@keyup.enter="guardarProceso" />
                    <button @@click="guardarProceso" class="btn btn-success" style="padding: 9px;"><i class="glyphicon glyphicon-ok"></i> Guardar</button>
                </div>
                <div v-else style="display: flex">
                    <input class="form-control" placeholder="Ingrese el nombre del Proceso" type="text" v-model="proceso.EditadoNombre" id="procesoEditNombre" @@keyup.enter="actualizarProceso" />
                    <button @@click="actualizarProceso" class="btn btn-success" style="padding: 9px;"><i class="glyphicon glyphicon-pencil"></i> Actualizar</button>
                </div>

                <!-- DataTable -->
                <div class="table-responsive" style="border-radius: 8px !important; margin-top: 10px">
                    <table class="table table-striped table-hover datatable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th class="text-center">Acciones</th>
                            </tr>
                        </thead>
                        <tbody style="background: #f9fafb ">
                            <tr v-for="(item, index) in procesos" :key="item.Id" :class="{'editing-row': proceso.isEditingProceso && proceso.EditadoIndex === index}">
                                <td>{{ item.Id }}</td>
                                <td>{{ item.Nombre }}</td>
                                <td class="text-center action-buttons">
                                    <button @@click="editarProceso(index)" class="btn btn-warning btn-sm">
                                        <i class="glyphicon glyphicon-pencil"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
@section js{
    <script src="~/Content/assets/js/optional/vue/vue.min.js"></script>
    <script src="~/Content/assets/viewsjs/GLPImodulo/asignarTickets.js"></script>
}